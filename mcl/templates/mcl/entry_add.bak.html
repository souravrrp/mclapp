{% extends 'mcl/base.html' %}
{% block title %}Check List Entry{%endblock%}
{% block content %}

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0">Check List Entry</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="{% url 'mcl:dashboard' %}">Home</a></li>
              <li class="breadcrumb-item">Check List</li>
              <li class="breadcrumb-item active">Check List Entry</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <div class="content">
      <div class="container">
        <div class="row mb-2">
          <div class="col-12 card">
            <div class="card-header">
              <h1 class="card-title">
                Check List Entry
              </h1>
            </div>
            <div class="card-body">
              <div class="col-md-12">
                {% if messages %}
                <div class="row">
                  <div class="col-md-12">
                    {% for message in messages %}
                    <div class="alert alert-{% if message.tags %}{{ message.tags }} {% endif %}" role="alert">
                      <p class="mb-0 text-center">{{ message }}</p>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              {% endif %}
               <!-- Form start-->
               <div class="row">
                <div class="col-12 col-sm-4">
                  <div class="info-box bg-primary mt-0">

                    <div class="ribbon-wrapper">
                      <div class="ribbon bg-warning">
                        SITE
                      </div>
                    </div>

                    <div class="info-box-content">
                      <span class="info-box-number text-center text-white">
                        Site: {{ site.code }} ({{ site.manager.first_name }} {{ site.manager.last_name }})
                      </span>
                      <span class="info-box-number text-center text-white">
                        Area: {{ site.district.area.name }} (D-{{ site.district }})
                      </span>
                      <span class="info-box-number text-center text-white mb-0">
                        Address: {{ site.address }}
                      </span>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-sm-4">
                  <div class="info-box bg-success mt-0">
                    
                    <div class="ribbon-wrapper">
                      <div class="ribbon bg-warning">
                        Visitor
                      </div>
                    </div>
                  
                    <div class="info-box-content">
                      <span class="info-box-number text-center text-white">
                        Date # {% now "jS F Y H:i A" %}
                      </span>
                      <span class="info-box-number text-center text-white">
                        Entry User: {{ request.user.username }}
                      </span>
                      <span class="info-box-number text-center text-white">
                         Name: {{ request.user.first_name }} {{ request.user.last_name }}
                      </span>
                      <span class="info-box-number text-center text-white mb-0">
                        Designation: {{ request.user.profile.designation }}
                     </span>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-sm-4">
                  <div class="info-box bg-danger mt-0">

                    <div class="ribbon-wrapper">
                        <div class="ribbon bg-warning">
                          Score
                        </div>
                    </div>

                    <div class="info-box-content">
                      <span class="info-box-number text-center text-white">
                        Point: 0 = Unjustifiable, 1 = Minimum Standard Earned,
                        2 = Very Good, 1 = Not Applicable, 0 = Not Attended 
                      </span>
                    </div>
                  </div>
                </div>
              </div>
               <form method ="POST" enctype="multipart/form-data">
                {% csrf_token %}
                {% regroup topics by category as topic_list %}
                <div class="table-responsive mt-4">
                    <table class="table table-striped table-hover table-bordered table-sm">
                        <thead>
                        {% for topic in topic_list %}
                            <tr class="check-list">
                                <th scope="col">{{ forloop.counter}}# {{ topic.grouper }}</th>
                                <th scope="col">Description</th>
                                <th scope="col">Unjustifiable</th>
                                <th scope="col">Minimum Standard Earned</th>
                                <th scope="col">Very Good</th>
                                <th scope="col">Not Applicable</th>
                                <th scope="col">Not Attended </th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for item in topic.list %}
                        <tr>
                            <th scope="row">{{ forloop.counter}}</th>
                            <td>{{ item.name_en }}</td>
                            <td><input type="radio" id="input" class="form-radio" name="qs{{ item.id }}" value="A" autocomplete='off' required></td>
                            <td><input type="radio" id="input" class="form-radio" name="qs{{ item.id }}" value="B" autocomplete='off' required></td>
                            <td><input type="radio" id="input" class="form-radio" name="qs{{ item.id }}" value="C" autocomplete='off' required></td>
                            <td><input type="radio" id="input" class="form-radio" name="qs{{ item.id }}" value="D" autocomplete='off' required></td>
                            <td><input type="radio" id="input" class="form-radio" name="qs{{ item.id }}" value="E" autocomplete='off' required></td>
                        </tr>
                        {% endfor %}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                  <div class="mt-3"></div>
                    <div class='col form-group'>
                      <label for="com_one">Comment 1:</label>
                      <select name="com_one" class="col form-select">
                        <option value="" selected>Choose...</option>
                        {% for com in comments %}
                        <option value="{{ com.id }}">{{ com.comment }}</option>
                        {% endfor %}
                      </select>
                    </div>
                  
                    <div class='col form-group'>
                      <label for="com_two">Comment 2:</label>
                      <select name="com_two" class="col form-select">
                        <option value="" selected>Choose...</option>
                        {% for com in comments %}
                        <option value="{{ com.id }}">{{ com.comment }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <div class='col form-group'>
                      <label for="com_three">Comment 3:</label>
                      <select name="com_three" class="col form-select">
                        <option value="" selected>Choose...</option>
                        {% for com in comments %}
                        <option value="{{ com.id }}">{{ com.comment }}</option>
                        {% endfor %}
                      </select>
                    </div>
 
                  <div class="form-group">
                      <label>Custom Comment</label>
                      <textarea class="form-control" name="cust_comm" rows="3" maxlength="250"></textarea>
                  </div>
                  <div class="form-group">
                      <div class="alert alert-danger d-none" id="file-msg" role="alert">
                        <p class="mb-0 text-center">Selected image type not allowed, please select allowed image type!</p>
                      </div>
                    <label>Image</label>
                    <p>
                      <span class="badge badge-primary">JPG</span> <span class="badge badge-warning">JPEG</span>
                      <span class="badge badge-success">GIF</span> <span class="badge badge-danger">PNG</span>
                    </p>
                    <input class="form-control" name="images" type="file" id="imageupload" onchange="checkextension()" accept="image/*" multiple>
                  </div>
                    <button type="submit" class="btn btn-primary mb-2" id="submit">Submit</button>
                </form>
               <!-- Form end-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /.content -->
</div>
  <!-- /.content-wrapper -->
{% endblock %}

{% block extra_js %}
<script>
function checkextension() {
  var file = document.querySelector("#imageupload");
  var fileMsg = document.getElementById("file-msg");
  if ( /\.(jpe?g|png|gif)$/i.test(file.files[0].name) === false )
    { 
      document.getElementById('imageupload').value= null;
      fileMsg.classList.add("d-block");
    }
    else{
      fileMsg.classList.remove("d-block");
    }
}
</script>
{% endblock %}